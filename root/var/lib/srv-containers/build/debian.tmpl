FROM docker.io/debian:@tag@

LABEL description="base debian @tag@" maintainer="Pierre Dorgueil <pierre.dorgueil@gmail.com>"

# install addon software, enable system services, set passwords to 'debian'
RUN export DEBIAN_FRONTEND=noninteractive DEBCONF_NONINTERACTIVE_SEEN=true; \
printf 'tzdata tzdata/Areas select Etc\ntzdata tzdata/Zones/Etc select MET\n' | debconf-set-selections; \
    sed -i '/^path-exclude=.usr.share.man/s/^/# /' /etc/dpkg/dpkg.cfg.d/excludes 2>/dev/null; \
    apt-get update -qqy; \
    apt-get install -qqy --no-install-recommends \
      apt-file \
      bash-completion \
      cockpit \
      cockpit-packagekit \
      cockpit-ws \
      curl \
      dnsutils \
      less \
      locate \
      man \
      ncat \
      net-tools \
      network-manager \
      nmap \
      openssh-server \
      sudo \
      systemd-sysv \
      tzdata \
      vim \
      wget \
      ;\
    apt-get clean; \
    sed -i '/pam_systemd.so/s/^/# /' /etc/pam.d/common-session; \
    for s in cockpit ssh network-manager; do systemctl enable $s; done; \
    for u in getty.target console-getty.service getty@.service; do systemctl mask $u; done; \
